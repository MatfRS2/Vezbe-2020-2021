# Вежбе -- Пети час -- Додавање корпе

[повратак](../../README.md)

**Наставак унапређивања и додавања нових функционалности интернет продавници.**

## Креирање корпе

- Креирати класу _Models/Korpa.cs_
- Изменити _ProizvodIspis.cshtml_: додати дугме за додавање производа у корпу и поље за одабир количине (креирати форму)
- Тренутна корпа се не чува у бази. Тек када корисник заврши куповину, корпу чувамо у бази (на неком наредном часу, у виду поруџбина). За сада корпу чувамо преко сесија. Сваки корисник има своју сесију (па је самим тим лако одржавати стање да сваки корисник има своју корпу).


## Задатак 2: додати дугме за повратак из корпе, али тако да корисник оде на ону страну коју је претходно гледао

- Пре одласка на списак корпе потребно је запамтити (прецизније проследити) тренутни url. 
- Зато се прави још један View Model: `KorpaViewModel` који има два податка: корпа и url.
- Да би покупили исправан url потребно је позвати неколико метода. Лепо објашњење како се креира url може се погледати [овде](https://stackoverflow.com/questions/16675191/get-full-url-and-query-string-in-servlet-for-both-http-and-https-requests). У фолдеру `Infrastructure` креира се класа `UrlExtension`. Креирање класе није било неопходно, могли су сви позиви да се обаве и у оквиру _Razor_ странице. Ипак, овакав приступ се сматра добром праксом.
- [Документација](https://docs.microsoft.com/en-us/dotnet/api/system.web.httprequest?redirectedfrom=MSDN&view=netframework-4.8#properties) за `HttpRequest` класу (коришћена у оквиру UrlExtension)

## Задатак 3: обрисати производ из корпе

- Додати дугме за брисање

## Задатак 4: на врху стране додати информације о тренутном стању у корпи

- Ово је део стране, па се као и код навигације користи ViewComponent. 
- Додати _font-awesome_ иконицу: `Add --> Client Side Library --> cdnjs --> font-awesome --> Install`

---

**Посматрати на даље _Prodavnica\_poboljsanje_**

- Може се приметити да се у `KorpaController` и `KorpaViewComponent` више пута појављују методи `SetKorpa` и `GetKorpa` и овако понављање кода није добро.
- Зато би било добро податке о корпи преузимати на неки другачији начин, коришћењем сервиса.
- Креирати класу која је сервис за корпу.
- **У реализацији овог примера интезивно је коришћена техника `Dependency injection`. Више о томе може се прочитати у званичној [документацији](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-3.1).**
- **[Лепо (илустративно) објашњење у разлици између `AddTransient`, `AddSingleton` и `AddScoped`](https://stackoverflow.com/questions/38138100/addtransient-addscoped-and-addsingleton-services-differences).**

[повратак](../../README.md)